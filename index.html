<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OfertasZ - Las mejores ofertas actualizadas</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 font-sans">

  <!-- CABECERA CON LOGO -->
  <header class="bg-white shadow">
    <div class="max-w-4xl mx-auto px-4 py-6 text-center">
      <div class="flex justify-center items-center flex-col mb-4">
  <a href="/">
  <img src="logo-ofertasz.jpg" alt="OfertasZ logo" class="h-16 mb-2 rounded-md hover:opacity-90 transition" />
</a>

  <p class="text-gray-500">Las mejores ofertas actualizadas autom√°ticamente</p>
</div>

      <p class="text-gray-500 mt-1">Las mejores ofertas actualizadas autom√°ticamente</p>
    </div>
  </header>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="max-w-4xl mx-auto px-4 py-8">
    <!-- Buscador -->
    <div class="mb-6">
      <input
        type="text"
        id="buscador"
        placeholder="üîç Buscar ofertas..."
        class="w-full p-3 border border-gray-300 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500"
      />
    </div>

    <!-- Ofertas -->
    <div id="ofertas" class="grid gap-4 sm:grid-cols-2"></div>
  </main>

  <!-- PIE DE P√ÅGINA -->
  <footer class="text-center text-gray-400 text-sm py-6">
    Hecho con ‚ù§Ô∏è por OfertasZ - Automatizado con Google Sheets & IFTTT
  </footer>

  <!-- L√ìGICA DE OFERTAS -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTSE7fEFVv-U8Zu1egpFcgj28fSq5KOpaDPbLRCvYLpaM0ERCIvvTRAbXZ6-RzT0Q8SRF7MZoLDWU9y/pub?gid=0&single=true&output=csv";

    let datosOriginales = [];

    function mostrarOfertas(filtro = "") {
      const container = document.getElementById("ofertas");
      container.innerHTML = "";

      const ofertasFiltradas = datosOriginales.filter(oferta =>
        (oferta.titulo && oferta.titulo.toLowerCase().includes(filtro)) ||
        (oferta.descripcion && oferta.descripcion.toLowerCase().includes(filtro))
      );

      if (ofertasFiltradas.length === 0) {
        container.innerHTML = "<p class='text-center text-gray-500'>No se encontraron ofertas.</p>";
        return;
      }

      ofertasFiltradas.forEach(oferta => {
        const card = document.createElement("div");
        card.className = "bg-white rounded-lg shadow p-4 hover:shadow-md transition text-sm";
        card.innerHTML = `
          <h2 class="text-base font-semibold mb-1">${oferta.titulo}</h2>
          <p class="text-gray-600 mb-1">${oferta.descripcion || ""}</p>
          <p class="text-xs text-gray-400 mb-3">üóì ${oferta.fecha || ""}</p>
          <a href="${oferta.enlace}" target="_blank" class="inline-block bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition text-sm">Ver oferta</a>
        `;
        container.appendChild(card);
      });
    }

    Papa.parse(SHEET_URL, {
      download: true,
      header: true,
      complete: function(results) {
        datosOriginales = results.data;
        mostrarOfertas();
      },
      error: function(err) {
        console.error("Error al leer CSV:", err);
      }
    });

    document.addEventListener("input", function (e) {
      if (e.target.id === "buscador") {
        const filtro = e.target.value.trim().toLowerCase();
        mostrarOfertas(filtro);
      }
    });
  </script>
</body>
</html>
